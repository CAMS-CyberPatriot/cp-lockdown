<!DOCTYPE html>
<head>
<meta charset="UTF-8">
<title>Ubuntu Lockdown</title>
</head>

<body>
<h1>Ubuntu</h1>
<div id="toc">
Users and Groups<ul>
<li><a href="#users">Users</a><br /></li>
<li><a href="#groups">Groups</a><br /></li>
</ul>
Networking<ul>
<li><a href="#firewall">Firewall</a><br /></li>
<li><a href="#network-connections">Network Connections</a><br /></li>
</ul>
Configuration<ul>
<li><a href="#services">Services</a><br /></li>
<li><a href="#updates">Updates</a><br /></li>
</ul>
Scans<ul>
</ul>
References<ul>
<li><a href="#terminal">Terminal</a><br /></li>
<li><a href="#system-settings">System Settings</a><br /></li>
<li><a href="#default-groups">Default Groups</a><br /></li>
<li><a href="#default-users">Default Users</a><br /></li>
</ul>
</div>
<hr><hr>
<h1>Users and Groups</h1>
<hr>
<div id="users">
<h2>Users</h2>
<h3>Location</h3>
<ol>
    <li>Open <a href="#terminal">terminal</a></li>
    <li>cat /etc/passwd</li>
</ol>
<h3>Settings</h3>
<ol>
    <li>Check <a href="#default-users">Default Users</a></li>
    <ul>
        <li>Check that the users specified in the readme exist. Double check the default users. Look out for unmentioned users.</li>
        <li>Line reference = [user]:x:[user id]:[group id]:[description]:[home directory]:[default shell]
        <li>User ID number less than 1000 are hidden users</li>
        <li>only user root should have User ID of 0</li>
    </ul>
    <li>To disable a user (unable to log in, keep files):</li>
    <ul>
        <li>sudo passwd -l [user]</li>
    </ul>
    <li>To remove a user and their files:</li>
    <ul>
        <li>sudo userdel -r [user]</li>
    </ul>
    <li>To add a user:</li>
    <ul>
        <li>sudo useradd -D [user]</li>
    </ul>
</ol>
<a href="#toc">Table of Contents</a>
</div>
<hr>
<div id="groups">
<h2>Groups</h2>
<h3>Location</h3>
<ol>
    <li>Open <a href="#terminal">terminal</a></li>
    <li>cat /etc/group</li>
</ol>
<h3>Settings</h3>
<ol>
    <li>Check <a href="#default-groups">Default Groups</a></li>
    <ul>
        <li>root group should be empty</li>
        <li>sudo group should only have administrator users</li>
        <li>users group should only have users specified in the readme</li>
        <li>each user may have a corresponding group</li>
    </ul>
    <li>To add a user to a group:</li>
    <ul>
        <li>sudo gpasswd -a [user] [group]</li>
    </ul>
    </li>To remove a user from a group:</li>
    <ul>
        <li>sudo gpasswd -d [user] [group]</li>
    </ul>
</ol>
<a href="#toc">Table of Contents</a>
</div>
<hr><hr>
<h1>Networking</h1>
<hr>
<div id="firewall">
<h2>Firewall</h2>
<h3>Location</h3>
<ol>
    <li>Open <a href="#terminal">Terminal</a></li>
    <li>sudo iptables [options]</li>
</ol><h3>Settings</h3>
<ol>
    <li>Check rules</a></li>
    <ol>
        <li>sudo iptables -nvL</li>
    </ol>
    <li>Reset rules</li>
    <ol>
        <li>sudo iptables -F</li>
        <li>sudo iptables -X</li>
    </ol>
    <li>Set default rules</li>
    <ol>
        <li>sudo iptables -A INPUT -m state --state INVALID -j DROP</li>
        <li>sudo iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</li>
        <li>sudo iptables -A INPUT -i lo -j ACCEPT</li>
    </ol>
    <li>Add allowed INPUT rule</li>
    <ol>
        <li>sudo iptables -A INPUT -p [protocol] --dport [port] -j ACCEPT</li>
        <li>Check Readme for required services. Research any required ports that need to be opened on firewall.</li>
        <li>Example for SSH: sudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT</li>
    </ol>
    <li>Set default policy</li>
    <ol>
        <li>sudo iptables -P INPUT DROP</li>
        <li>sudo iptables -P FORWARD DROP</li>
        <li>sudo iptables -P OUTPUT ACCEPT</li>
    </ol>
</ol><a href="#toc">Table of Contents</a>
</div>
<hr>
<div id="network-connections">
<h2>Network Connections</h2>
<h3>Location</h3>
<ol>
    <li>Open <a href="#terminal">Terminal</a></li>
    <li>sudo netstat [options]</li>
</ol>
<h3>Settings</h3>
<ol>
    <li>Check listening network connections</li>
    <ol>
        <li>netstat -ntulp</li>
        <li>Make sure only necessary services have listening connections on the correct ports</li>
    </ol>
    <li>Check established network connections</li>
    <ol>
        <li>netstat -tupn</li>
    </ol>
</ol><a href="#toc">Table of Contents</a>
</div>
<hr><hr>
<h1>Configuration</h1>
<hr>
<div id="services">
<h2>Services</h2>
<h3>Location</h3>
<ol>
    <li>Open <a href="#terminal">terminal</a></li>
</ol>
<h3>Settings</h3>
<p>Check status of all services</p>
<ul>
    <li>service --status-all</li>
</ul>
<p>Check status of one service (may not always work)</p>
<ul>
    <li>service [service-name] status</li>
</ul>
<p>Other common service commands</p>
<ul>
    <li>service [service-name] start</li>
    <li>service [service-name] stop</li>
    <li>service [service-name] restart</li>
</ul>
<h3>Disable service autostart</h3>
<p>service [service-name] stop</p>
<p>update-rc.d -f [service] remove</p>
<h3>Common Services</h3>
<p>The following services should be disabled if they are not required</p>
<p>Database<p>
<ul>
    <li>mysqld</li>
    <li>postgres</li>
</ul>
<p>E-mail</p>
<ul>
    <li>dovecot</li>
    <li>exim4</li>
    <li>postfix</li>
</ul>
<p>File Sharing</p>
<ul>
    <li>nfs</li>
    <li>nmbd</li>
    <li>rpc.mountd</li>
    <li>rpc.nfsd</li>
    <li>smbd</li>
    <li>vsftpd</li>
</ul>
<p>Music</p>
<ul>
    <li>mpd</li>
</ul>
<p>Networking</p>
<ul>
    <li>avahi-daemon</li>
    <li>bind</li>
    <li>dnsmasq</li>
    <li>xinetd</li>
    <li>inetd</li>
    <li>sshd</li>
    <li>telnet</li>
</ul>
<p>Printing, Scanning</p>
<ul>
    <li>cupsd</li>
    <li>saned</li>
</ul>
<p>Time</p>
<ul>
    <li>ntpd</li>
</ul>
<p>Scheduled tasks</p>
<ul>
    <li>cron</li>
</ul>
<p>Web Server<p>
<ul>
    <li>apache2</li>
    <li>httpd</li>
    <li>jetty</li>
    <li>nginx</li>
    <li>tomcat</li>
</ul>
<a href="#toc">Table of Contents</a>
</div>
<hr>
<div id="updates">
<h2>Updates</h2>
<ol>
    <li>Open <a href="#system-settings">System Settings</a></li>
    <li>Under <b>System</b> section, find and click on <b>Software & Updates</b></li>
    <li>Press <b>Revert</b> for default settings</li>
    <li>For Ubuntu Software tab
        <ol>
            <li>[x] Canonical-supported free and open-source software (main)</li>
            <li>[Optional] Community-maintained free and open-source software (universe)</li>
            <li>[Optional] Proprietary drivers for devices (restricted)</li>
            <li>[Optional] Software restricted by copyright or legal issues (multiverse)</li>
            <li>Download from: [Server near you]</li>
        </ol>
    </li>
    <li>For Updates tab
        <ol>
            <li>[x] Important security updates (*-security)</li>
            <li>[x] Recommended updates (*-updates)</li>
            <li>[Optional] Pre-release updates (*-proposed)</li>
            <li>[Optional] Unsupported updates (*-backports)</li>
            <li>Automatic check for updates: Daily</li>
            <li>When there are security updates: Display immediately</li>
        </ol>
    </li>
    <li>Open <a href="#terminal">terminal</a></li>
    <li>sudo apt-get update && sudo apt-get upgrade -y</li>
</ol>
<a href="#toc">Table of Contents</a>
</div>
<hr><hr>
<h1>Scans</h1>
<hr><hr>
<h1>References</h1>
<hr>
<div id="terminal">
<h2>Terminal</h2>
Option 1
<ol>
    <li>Press Ubuntu icon button</li>
    <li>Type '<strong>terminal</strong>', press Enter</li>
</ol>
Option 2
<ol>
    <li>Click on <strong>Applications</strong> menu</li>
    <li>Go to <strong>Accessories</strong></li>
    <li>Click on <strong>Terminal</strong></li>
</ol>
<a href="#toc">Table of Contents</a>
</div>
<hr>
<div id="system-settings">
<h2>System Settings</h2>
<ol>
    <li>Press the gear-like icon at the top right of the screen. (Next to the current time)</li>
    <li>Click on <b>System Settings</b></li>
</ol>
<a href="#toc">Table of Contents</a>
</div>
<hr>
<div id="default-groups">
<h2>Default Groups</h2>
<ul>
    <li>root</li>
    <li>daemon</li>
    <li>bin</li>
    <li>sys</li>
    <li>adm</li>
    <li>tty</li>
    <li>disk</li>
    <li>lp</li>
    <li>mail</li>
    <li>news</li>
    <li>uucp</li>
    <li>man</li>
    <li>proxy</li>
    <li>kmem</li>
    <li>dialout</li>
    <li>fax</li>
    <li>voice</li>
    <li>cdrom</li>
    <li>floppy</li>
    <li>tape</li>
    <li>sudo</li>
    <li>audio</li>
    <li>dip</li>
    <li>www-data</li>
    <li>backup</li>
    <li>operator</li>
    <li>list</li>
    <li>irc</li>
    <li>src</li>
    <li>gnats</li>
    <li>shadow</li>
    <li>utmp</li>
    <li>video</li>
    <li>sasl</li>
    <li>plugdev</li>
    <li>staff</li>
    <li>games</li>
    <li>users</li>
    <li>nogroup</li>
    <li>libuuid</li>
    <li>crontab</li>
    <li>syslog</li>
    <li>fuse</li>
    <li>messagebus</li>
    <li>bluetooth</li>
    <li>scanner</li>
    <li>colord</li>
    <li>lpadmin</li>
    <li>ssl-cert</li>
    <li>lightdm</li>
    <li>nopasswdlogin</li>
    <li>netdev</li>
    <li>whoopsie</li>
    <li>mlocate</li>
    <li>ssh</li>
    <li>avahi-autoipd</li>
    <li>avahi</li>
    <li>pulse</li>
    <li>pulse-access</li>
    <li>utempter</li>
    <li>rtkit</li>
    <li>saned</li>
    <li>ubuntu</li>
    <li>sambashare</li>
</ul>
<a href="#toc">Table of Contents</a>
</div>
<hr>
<div id="default-users">
<h2>Default Users</h2>
<ul>
    <li>root</li>
    <li>daemon</li>
    <li>bin</li>
    <li>sys</li>
    <li>sync</li>
    <li>games</li>
    <li>man</li>
    <li>lp</li>
    <li>mail</li>
    <li>news</li>
    <li>uucp</li>
    <li>proxy</li>
    <li>www-data</li>
    <li>backup</li>
    <li>list</li>
    <li>irc</li>
    <li>gnats</li>
    <li>nobody</li>
    <li>libuuid</li>
    <li>syslog</li>
    <li>messagebus</li>
    <li>colord</li>
    <li>lightdm</li>
    <li>whoopsie</li>
    <li>avahi-autoipd</li>
    <li>avahi</li>
    <li>usbmux</li>
    <li>kernoops</li>
    <li>pulse</li>
    <li>rtkit</li>
    <li>speech-dispatcher</li>
    <li>dispatcher</li>
    <li>hplip</li>
    <li>saned</li>
    <li>ubuntu</li>
</ul>
<a href="#toc">Table of Contents</a>
</div>
</body>
</html>